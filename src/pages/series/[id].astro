---
import Layout from "@/layouts/Layout.astro";
import SeriesHeader from "@/components/series/SeriesHeader.astro";
import LeaderboardSection from "@/components/series/LeaderboardSection.astro";
import PtsProgressionChartSection from "@/components/series/PtsProgressionChartSection.astro";
import WinRatePieChartSection from "@/components/series/WinRatePieChartSection.astro";
import GamesListSection from "@/components/series/GamesListSection.astro";

// Import skeletons
import SeriesHeaderSkeleton from "@/components/series/skeletons/SeriesHeaderSkeleton.astro";
import LeaderboardSectionSkeleton from "@/components/series/skeletons/LeaderboardSectionSkeleton.astro";
import PtsProgressionChartSectionSkeleton from "@/components/series/skeletons/PtsProgressionChartSectionSkeleton.astro";
import WinRatePieChartSectionSkeleton from "@/components/series/skeletons/WinRatePieChartSectionSkeleton.astro";
import GamesListSectionSkeleton from "@/components/series/skeletons/GamesListSectionSkeleton.astro";

const { id } = Astro.params;

if (!id) {
  return Astro.redirect("/");
}
---

<Layout title="Series - Brawl Master Tracker">
  <div class="space-y-8">
    <!-- Series Header -->
    <SeriesHeader seriesId={id} server:defer>
      <SeriesHeaderSkeleton slot="fallback" />
    </SeriesHeader>

    <!-- Leaderboard -->
    <LeaderboardSection seriesId={id} server:defer>
      <LeaderboardSectionSkeleton slot="fallback" />
    </LeaderboardSection>

    <!-- Charts -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <PtsProgressionChartSection seriesId={id} server:defer>
        <PtsProgressionChartSectionSkeleton slot="fallback" />
      </PtsProgressionChartSection>

      <WinRatePieChartSection seriesId={id} server:defer>
        <WinRatePieChartSectionSkeleton slot="fallback" />
      </WinRatePieChartSection>
    </div>

    <!-- Games List -->
    <GamesListSection seriesId={id} server:defer>
      <GamesListSectionSkeleton slot="fallback" />
    </GamesListSection>
  </div>
</Layout>